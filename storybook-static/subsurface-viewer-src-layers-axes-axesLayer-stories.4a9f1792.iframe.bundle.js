"use strict";(self.webpackChunk_webviz_subsurface_components=self.webpackChunk_webviz_subsurface_components||[]).push([[3266],{"./node_modules/@babel/runtime/helpers/esm/defineProperty.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return _defineProperty}});var esm_typeof=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/typeof.js");function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==(0,esm_typeof.Z)(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==(0,esm_typeof.Z)(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===(0,esm_typeof.Z)(key)?key:String(key)}function _defineProperty(obj,key,value){return(key=_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},"./node_modules/@babel/runtime/helpers/esm/typeof.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}__webpack_require__.d(__webpack_exports__,{Z:function(){return _typeof}})},"./packages/subsurface-viewer/src/layers/axes/axesLayer.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Baseline:function(){return Baseline},CustomLabel:function(){return CustomLabel},DarkMode:function(){return DarkMode},__namedExportsOrder:function(){return __namedExportsOrder}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_deck_gl_react_typed__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@deck.gl/react/dist/esm/deckgl.js"),d3_color__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/d3-color/src/color.js"),_deck_gl_core_typed__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@deck.gl/core/dist/esm/views/orthographic-view.js"),_axesLayer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/subsurface-viewer/src/layers/axes/axesLayer.ts");__webpack_exports__.default={parameters:{storySource:{source:'import React from "react";\nimport DeckGL from "@deck.gl/react/typed";\nimport { rgb } from "d3-color";\nimport { OrthographicView } from "@deck.gl/core/typed";\nimport AxesLayer from "./axesLayer";\nexport default {\n  component: DeckGL,\n  title: "SubsurfaceViewer / Axes"\n};\nconst layerProps = {\n  name: "axes",\n  bounds: [-100, -100, 0, 100, 100, 100]\n};\nfunction getRgba(color) {\n  const c = rgb(color);\n  return [c.r, c.g, c.b, c.opacity * 255];\n}\nexport const Baseline = args => {\n  args.layers = [new AxesLayer({\n    ...layerProps\n  })];\n  args.views = [new OrthographicView({})];\n  return /*#__PURE__*/React.createElement(DeckGL, args);\n};\nfunction ColoredLabels(props) {\n  const layers = [new AxesLayer({\n    ...layerProps,\n    labelColor: getRgba(props.labelColor),\n    axisColor: getRgba(props.axisColor)\n  })];\n  const views = [new OrthographicView({})];\n  return /*#__PURE__*/React.createElement(DeckGL, {\n    layers: layers,\n    views: views\n  });\n}\nexport const DarkMode = args => {\n  return /*#__PURE__*/React.createElement(ColoredLabels, args);\n};\nDarkMode.args = {\n  labelColor: "white",\n  axisColor: "white"\n};\nDarkMode.parameters = {\n  backgrounds: {\n    default: "dark"\n  }\n};\nexport const CustomLabel = args => {\n  return /*#__PURE__*/React.createElement(CustomLabels, args);\n};\nfunction CustomLabels(props) {\n  const layers = [new AxesLayer({\n    ...layerProps,\n    labelColor: getRgba(props.labelColor),\n    labelFontSize: props.labelFontSize,\n    fontFamily: props.fontFamily\n  })];\n  const views = [new OrthographicView({})];\n  return /*#__PURE__*/React.createElement(DeckGL, {\n    layers: layers,\n    views: views\n  });\n}\nCustomLabel.args = {\n  labelColor: "blue",\n  labelFontSize: 10,\n  fontFamily: "math"\n};\nBaseline.parameters = {\n  ...Baseline.parameters,\n  docs: {\n    ...Baseline.parameters?.docs,\n    source: {\n      originalSource: "args => {\\n  args.layers = [new AxesLayer({\\n    ...layerProps\\n  })];\\n  args.views = [new OrthographicView({})];\\n  return <DeckGL {...args} />;\\n}",\n      ...Baseline.parameters?.docs?.source\n    }\n  }\n};\nDarkMode.parameters = {\n  ...DarkMode.parameters,\n  docs: {\n    ...DarkMode.parameters?.docs,\n    source: {\n      originalSource: "args => {\\n  return <ColoredLabels {...args} />;\\n}",\n      ...DarkMode.parameters?.docs?.source\n    }\n  }\n};\nCustomLabel.parameters = {\n  ...CustomLabel.parameters,\n  docs: {\n    ...CustomLabel.parameters?.docs,\n    source: {\n      originalSource: "args => {\\n  return <CustomLabels {...args} />;\\n}",\n      ...CustomLabel.parameters?.docs?.source\n    }\n  }\n};',locationsMap:{baseline:{startLoc:{col:24,line:18},endLoc:{col:1,line:24},startBody:{col:24,line:18},endBody:{col:1,line:24}},"dark-mode":{startLoc:{col:24,line:37},endLoc:{col:1,line:39},startBody:{col:24,line:37},endBody:{col:1,line:39}},"custom-label":{startLoc:{col:27,line:49},endLoc:{col:1,line:51},startBody:{col:27,line:49},endBody:{col:1,line:51}}}}},component:_deck_gl_react_typed__WEBPACK_IMPORTED_MODULE_2__.Z,title:"SubsurfaceViewer / Axes"};const layerProps={name:"axes",bounds:[-100,-100,0,100,100,100]};function getRgba(color){const c=(0,d3_color__WEBPACK_IMPORTED_MODULE_3__.B8)(color);return[c.r,c.g,c.b,255*c.opacity]}const Baseline=args=>(args.layers=[new _axesLayer__WEBPACK_IMPORTED_MODULE_1__.Z({...layerProps})],args.views=[new _deck_gl_core_typed__WEBPACK_IMPORTED_MODULE_4__.Z({})],react__WEBPACK_IMPORTED_MODULE_0__.createElement(_deck_gl_react_typed__WEBPACK_IMPORTED_MODULE_2__.Z,args));function ColoredLabels(props){const layers=[new _axesLayer__WEBPACK_IMPORTED_MODULE_1__.Z({...layerProps,labelColor:getRgba(props.labelColor),axisColor:getRgba(props.axisColor)})],views=[new _deck_gl_core_typed__WEBPACK_IMPORTED_MODULE_4__.Z({})];return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_deck_gl_react_typed__WEBPACK_IMPORTED_MODULE_2__.Z,{layers:layers,views:views})}const DarkMode=args=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(ColoredLabels,args);DarkMode.args={labelColor:"white",axisColor:"white"},DarkMode.parameters={backgrounds:{default:"dark"}};const CustomLabel=args=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(CustomLabels,args);function CustomLabels(props){const layers=[new _axesLayer__WEBPACK_IMPORTED_MODULE_1__.Z({...layerProps,labelColor:getRgba(props.labelColor),labelFontSize:props.labelFontSize,fontFamily:props.fontFamily})],views=[new _deck_gl_core_typed__WEBPACK_IMPORTED_MODULE_4__.Z({})];return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_deck_gl_react_typed__WEBPACK_IMPORTED_MODULE_2__.Z,{layers:layers,views:views})}CustomLabel.args={labelColor:"blue",labelFontSize:10,fontFamily:"math"},Baseline.parameters={...Baseline.parameters,docs:{...Baseline.parameters?.docs,source:{originalSource:"args => {\n  args.layers = [new AxesLayer({\n    ...layerProps\n  })];\n  args.views = [new OrthographicView({})];\n  return <DeckGL {...args} />;\n}",...Baseline.parameters?.docs?.source}}},DarkMode.parameters={...DarkMode.parameters,docs:{...DarkMode.parameters?.docs,source:{originalSource:"args => {\n  return <ColoredLabels {...args} />;\n}",...DarkMode.parameters?.docs?.source}}},CustomLabel.parameters={...CustomLabel.parameters,docs:{...CustomLabel.parameters?.docs,source:{originalSource:"args => {\n  return <CustomLabels {...args} />;\n}",...CustomLabel.parameters?.docs?.source}}};const __namedExportsOrder=["Baseline","DarkMode","CustomLabel"]},"./packages/subsurface-viewer/src/layers/axes/axesLayer.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return AxesLayer}});var composite_layer=__webpack_require__("./node_modules/@deck.gl/core/dist/esm/lib/composite-layer.js"),orthographic_viewport=__webpack_require__("./node_modules/@deck.gl/core/dist/esm/viewports/orthographic-viewport.js"),constants=__webpack_require__("./node_modules/@deck.gl/core/dist/esm/lib/constants.js"),lib_layer=__webpack_require__("./node_modules/@deck.gl/core/dist/esm/lib/layer.js"),project=__webpack_require__("./node_modules/@deck.gl/core/dist/esm/shaderlib/project/project.js"),esm=__webpack_require__("./node_modules/@luma.gl/constants/dist/esm/index.js"),model=__webpack_require__("./node_modules/@luma.gl/engine/dist/esm/lib/model.js"),geometry=__webpack_require__("./node_modules/@luma.gl/engine/dist/esm/geometry/geometry.js");const defaultProps={name:"Box",id:"box-layer",coordinateSystem:constants.COORDINATE_SYSTEM.CARTESIAN,lines:[],color:[0,0,0,1]};class BoxLayer extends lib_layer.Z{initializeState(context){const{gl:gl}=context;this.setState(this._getModels(gl))}shouldUpdateState(){return!0}updateState({context:context}){const{gl:gl}=context;this.setState(this._getModels(gl))}_getModels(gl){const color=this.props.color.map((x=>(x??0)/255)),grids=new model.Z(gl,{id:`${this.props.id}-grids`,vs:"#version 300 es\n#define SHADER_NAME graph-layer-axis-vertex-shader\n\nprecision highp float;\n\nin  vec3 positions;\n\nvoid main(void) {\n   vec3 position_commonspace = project_position(positions);\n   gl_Position = project_common_position_to_clipspace(vec4(position_commonspace, 0.0));\n}\n",fs:"#version 300 es\n#define SHADER_NAME graph-layer-fragment-shader\n\nprecision highp float;\n\nout vec4 fragColor;\n\nuniform vec4 uColor;\n\nvoid main(void) {\n  fragColor = uColor;\n}\n",uniforms:{uColor:color},geometry:new geometry.Z({drawMode:esm.default.LINES,attributes:{positions:new Float32Array(this.props.lines)},vertexCount:this.props.lines.length/3}),modules:[project.Z],isInstanced:!1});return{model:grids,models:[grids].filter(Boolean),modelsByName:{grids:grids}}}}BoxLayer.layerName="BoxLayer",BoxLayer.defaultProps=defaultProps;var text_layer_text_layer=__webpack_require__("./node_modules/@deck.gl/layers/dist/esm/text-layer/text-layer.js"),lodash=__webpack_require__("./node_modules/lodash/lodash.js");class AxesLayer extends composite_layer.Z{rebuildData(reportBoundingBox){const bounds=(0,lodash.cloneDeep)(this.props.bounds);this.props.ZIncreasingDownwards&&(bounds[2]*=-1,bounds[5]*=-1),bounds[2]>bounds[5]&&([bounds[2],bounds[5]]=[bounds[5],bounds[2]]),bounds[0]>bounds[3]&&([bounds[0],bounds[3]]=[bounds[3],bounds[0]]),bounds[1]>bounds[4]&&([bounds[1],bounds[4]]=[bounds[4],bounds[1]]);const box_lines=function GetBoxLines(bounds){const x_min=bounds[0],x_max=bounds[3],y_min=bounds[1],y_max=bounds[4],z_min=bounds[2],z_max=bounds[5];return[x_min,y_min,z_min,x_max,y_min,z_min,x_min,y_min,z_min,x_min,y_max,z_min,x_min,y_max,z_min,x_max,y_max,z_min,x_max,y_max,z_min,x_max,y_min,z_min,x_min,y_min,z_max,x_max,y_min,z_max,x_min,y_min,z_max,x_min,y_max,z_max,x_min,y_max,z_max,x_max,y_max,z_max,x_max,y_max,z_max,x_max,y_min,z_max,x_min,y_min,z_min,x_min,y_min,z_max,x_max,y_min,z_min,x_max,y_min,z_max,x_max,y_max,z_min,x_max,y_max,z_max,x_min,y_max,z_min,x_min,y_max,z_max]}(bounds),is_orthographic=this.context.viewport.constructor===orthographic_viewport.Z,[tick_lines,tick_labels]=function GetTickLines(isZIncreasingDownwards,is_orthographic,bounds,viewport){const ndecimals=0,n_minor_ticks=3,x_min=bounds[0],x_max=bounds[3],y_min=bounds[1],y_max=bounds[4],z_min=bounds[2],z_max=bounds[5],lines=[],tick_labels=[];let x_tick=0,y_tick=0,z_tick=0;const delta=(x_max-x_min+(y_max-y_min)+(z_max-z_min))/3*.025,Lz=LineLengthInPixels([x_min,y_min,z_min],[x_min,y_min,z_max],viewport);if(!is_orthographic){const z_ticks=GetTicks(z_min,z_max,Lz);x_tick=x_min,y_tick=y_min;for(let i=0;i<z_ticks.length;i++){const tick=z_ticks[i],label=((isZIncreasingDownwards?-1:1)*tick).toFixed(ndecimals);tick_labels.push(label),lines.push(x_tick,y_tick,tick);const x=-delta*Math.cos(.7853925),y=-delta*Math.sin(.7853925);lines.push(x_tick+x,y_tick+y,tick)}if(z_ticks.length>1){const tick1=z_ticks[0],d=(z_ticks[1]-tick1)/(n_minor_ticks+1),z_start=tick1;let i=0;for(;z_start+(i+1)*d<z_max;){const tick=z_start+(i+1)*d;tick_labels.push(""),i++,lines.push(x_tick,y_tick,tick);const x=-.5*delta*Math.cos(.7853925),y=-.5*delta*Math.sin(.7853925);lines.push(x_tick+x,y_tick+y,tick)}for(i=0;z_start-(i+1)*d>z_min;){const tick=z_start-(i+1)*d;tick_labels.push(""),i++,lines.push(x_tick,y_tick,tick);const x=-.5*delta*Math.cos(.7853925),y=-.5*delta*Math.sin(.7853925);lines.push(x_tick+x,y_tick+y,tick)}}}const Lx=LineLengthInPixels([x_min,y_min,z_min],[x_max,y_min,z_min],viewport),x_ticks=GetTicks(x_min,x_max,Lx);y_tick=y_min,z_tick=z_min;for(let i=0;i<x_ticks.length;i++){const tick=x_ticks[i],label=tick.toFixed(ndecimals);tick_labels.push(label),lines.push(tick,y_tick,z_tick);const z=0,y=-delta;lines.push(tick,y_tick+y,z_tick+z)}if(x_ticks.length>1){const tick1=x_ticks[0],d=(x_ticks[1]-tick1)/(n_minor_ticks+1),x_start=tick1;let i=0;for(;x_start+(i+1)*d<x_max;){const tick=x_start+(i+1)*d;tick_labels.push(""),i++,lines.push(tick,y_tick,z_tick);const z=0,y=-.5*delta;lines.push(tick,y_tick+y,z_tick+z)}for(i=0;x_start-(i+1)*d>x_min;){const tick=x_start-(i+1)*d;tick_labels.push(""),i++,lines.push(tick,y_tick,z_tick);const z=0,y=-.5*delta;lines.push(tick,y_tick+y,z_tick+z)}}const Ly=LineLengthInPixels([x_min,y_min,z_min],[x_min,y_max,z_min],viewport),y_ticks=GetTicks(y_min,y_max,Ly);for(let i=0;i<y_ticks.length;i++){const tick=y_ticks[i],label=tick.toFixed(ndecimals);tick_labels.push(label);const x_tick=x_min,z_tick=z_min;lines.push(x_tick,tick,z_tick);const z=0,x=-delta;if(lines.push(x_tick+x,tick,z_tick+z),y_ticks.length>1){const tick1=y_ticks[0],d=(y_ticks[1]-tick1)/(n_minor_ticks+1),y_start=tick1;let i=0;for(;y_start+(i+1)*d<y_max;){const tick=y_start+(i+1)*d;tick_labels.push(""),i++,lines.push(x_tick,tick,z_tick);const z=0,x=-.5*delta;lines.push(x_tick+x,tick,z_tick+z)}for(i=0;y_start-(i+1)*d>y_min;){const tick=y_start-(i+1)*d;tick_labels.push(""),i++,lines.push(x_tick,tick,z_tick);const z=0,x=-.5*delta;lines.push(x_tick+x,tick,z_tick+z)}}}return[lines,tick_labels]}(this.props.ZIncreasingDownwards,is_orthographic,bounds,this.context.viewport),textlayerData=function maketextLayerData(is_orthographic,tick_lines,tick_labels,bounds,labelFontSize){const x_min=bounds[0],x_max=bounds[3],y_min=bounds[1],y_max=bounds[4],z_min=bounds[2],z_max=bounds[5],dx=Math.abs(x_max-x_min),dy=Math.abs(y_max-y_min),dz=Math.abs(z_max-z_min),offset=(dx+dy+dz)/3*.1,data=[{label:"X",from:[0,0,0],to:[x_max+offset,y_min,z_min],size:labelFontSize??26},{label:"Y",from:[0,0,0],to:[x_min,y_max+offset,z_min],size:labelFontSize??26}];if(!is_orthographic){const z_axis_annotaion={label:"Z",from:[0,0,0],to:[x_min,y_min,z_max+offset],size:labelFontSize??26};data.push(z_axis_annotaion)}for(let i=0;i<tick_lines.length/6;i++){const from=[tick_lines[6*i+0],tick_lines[6*i+1],tick_lines[6*i+2]],to=[tick_lines[6*i+3],tick_lines[6*i+4],tick_lines[6*i+5]],label=tick_labels[i];data.push({label:label,from:from,to:to,size:labelFontSize??11})}return data}(is_orthographic,tick_lines,tick_labels,bounds,this.props.labelFontSize);this.setState({box_lines:box_lines,tick_lines:tick_lines,textlayerData:textlayerData}),void 0!==this.props.setReportedBoundingBox&&reportBoundingBox&&this.props.setReportedBoundingBox(bounds)}initializeState(){this.rebuildData(!0)}shouldUpdateState({props:props,oldProps:oldProps,context:context,changeFlags:changeFlags}){return super.shouldUpdateState({props:props,oldProps:oldProps,context:context,changeFlags:changeFlags})||changeFlags.viewportChanged}updateState(){this.rebuildData(!1)}getAnchor(d,is_orthographic){const is_xaxis=d.from[1]!==d.to[1];if(is_orthographic&&is_xaxis)return"middle";const screen_from=this.context.viewport.project(d.from),screen_to=this.context.viewport.project(d.to);return"X"!==d.label&&"Y"!==d.label&&"Z"!==d.label&&screen_from[0]<screen_to[0]?"start":"end"}getLabelPosition(d){if("X"!==d.label&&"Y"!==d.label&&"Z"!==d.label){const tick_vec=[d.to[0]-d.from[0],d.to[1]-d.from[1]];d.to[2]&&d.from[2]&&tick_vec.push(d.to[2]-d.from[2]);const s=.5;return[d.to[0]+s*tick_vec[0],d.to[1]+s*tick_vec[1],d.to[2]+s*tick_vec[2]]}return d.to}getBaseLine(d,is_orthographic){if("X"===d.label)return"center";const is_xaxis_label=d.from[1]!==d.to[1];return is_orthographic&&is_xaxis_label?"top":"center"}renderLayers(){const is_orthographic=this.context.viewport.constructor===orthographic_viewport.Z,lines=[...this.state.box_lines,...this.state.tick_lines];return[new BoxLayer(this.getSubLayerProps({lines:lines,coordinateSystem:constants.COORDINATE_SYSTEM.CARTESIAN,color:this.props.axisColor||[0,0,0,255]})),new text_layer_text_layer.Z(this.getSubLayerProps({fontFamily:this.props.fontFamily??"Monaco, monospace",data:this.state.textlayerData,id:"text-layer",pickable:!0,getPosition:d=>this.getLabelPosition(d),getText:d=>d.label,sizeUnits:"pixels",getSize:d=>d.size,getAngle:0,getTextAnchor:d=>this.getAnchor(d,is_orthographic),getAlignmentBaseline:d=>this.getBaseLine(d,is_orthographic),coordinateSystem:constants.COORDINATE_SYSTEM.CARTESIAN,getColor:this.props.labelColor||[0,0,0,255]}))]}}function LineLengthInPixels(p0,p1,viewport){const screen_from=viewport.project(p0),screen_to=viewport.project(p1),v=[screen_from[0]-screen_to[0],screen_from[1]-screen_to[1],screen_from[2]-screen_to[2]];return Math.sqrt(v[0]*v[0]+v[1]*v[1])}function GetTicks(min,max,axis_pixel_length){let step=Math.min(Math.round(axis_pixel_length/100)+1,20);const range=max-min,delta=Math.abs(range)/step;let decade=1;if(delta>=10){const logde=Math.log10(delta),pot=Math.floor(logde);decade=Math.pow(10,pot)}let scaled_delta=Math.round(delta/decade);3==scaled_delta?scaled_delta=2:4==scaled_delta||6==scaled_delta||7==scaled_delta?scaled_delta=5:scaled_delta>7?scaled_delta=10:scaled_delta<1&&(scaled_delta=1);const incr=scaled_delta*decade,start=Math.ceil(min/incr)*incr,stop=Math.floor(max/incr)*incr,calc_step=Math.floor(Math.abs(stop-start)/incr);step=calc_step>0?calc_step:0;const ticks=[];for(let i=0;i<=step;i++){const x=start+i*incr;ticks.push(x)}return ticks}AxesLayer.layerName="AxesLayer",AxesLayer.defaultProps={"@@type":"AxesLayer",name:"Axes",id:"axes-layer",visible:!0,ZIncreasingDownwards:!0}}}]);